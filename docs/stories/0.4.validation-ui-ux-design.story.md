# Story 0.4: Validation UI/UX Design

## Status

**Draft**

---

## Story

**As a** product manager,
**I want** a well-designed validation UI/UX specification for mandatory entity review,
**so that** users can efficiently verify 50-70% of entities without validation feeling burdensome.

---

## Acceptance Criteria

1. **AC1:** CLI validation workflow designed for speed and efficiency:
   - Keyboard-driven interface (minimal mouse interaction)
   - Batch operations (confirm all PERSON entities, reject all ORG false positives)
   - Smart defaults (pre-accept high-confidence entities if confidence scores available)

2. **AC2:** Entity presentation format specified:
   - Grouped by entity type (PERSON, LOCATION, ORG)
   - Show context (surrounding text snippet)
   - Highlight entity in document preview
   - Display confidence score (if available from NER)

3. **AC3:** User action taxonomy defined:
   - ‚úÖ **Confirm:** Accept entity and suggested pseudonym
   - ‚ùå **Reject:** Remove false positive
   - ‚úèÔ∏è **Modify:** Edit entity text (e.g., "Marie" ‚Üí "Marie Dubois" for full name)
   - ‚ûï **Add:** Manually add missed entity
   - üîÑ **Change Pseudonym:** Override suggested pseudonym

4. **AC4:** Validation workflow steps documented:
   - **Step 1:** Show summary (X entities detected: Y PERSON, Z LOCATION, etc.)
   - **Step 2:** Review by entity type (most critical first: PERSON ‚Üí ORG ‚Üí LOCATION)
   - **Step 3:** Confirm ambiguous standalone components (flagged by FR4 logic)
   - **Step 4:** Final confirmation before processing

5. **AC5:** Target validation time per document:
   - **Goal:** <2 minutes for 2-5K word document
   - **Benchmark:** Test with 5 sample documents, measure time
   - **Optimization:** Identify bottlenecks, iterate on UX

6. **AC6:** Validation UI library selected:
   - **Primary candidate:** `rich` (already in tech stack for progress bars)
   - **Features needed:** Tables, color coding, keyboard input, interactive menus
   - **Alternative:** `questionary` or `inquirer` for CLI forms

7. **AC7:** Wireframe/mockup created for validation workflow:
   - ASCII mockup of CLI interface
   - Example validation session walkthrough
   - Edge case handling (0 entities detected, 100+ entities detected)

8. **AC8:** Validation UI spec reviewed by:
   - PM (user experience perspective)
   - Dev (implementation feasibility)
   - 1-2 target users (5-minute feedback session)

9. **AC9 (CRITICAL):** Validation UX reduces burden perception:
   - **User expectation:** "Quick review" not "tedious work"
   - **Design principle:** Default to AI suggestions, user confirms/overrides
   - **Psychological framing:** "Quality control" not "doing AI's job"

---

## Tasks / Subtasks

- [ ] **Task 1: Research Existing CLI Validation UX Patterns** (AC: 6, 9)
  - [ ] Research best-in-class CLI interactive tools: git interactive rebase, npm audit fix, docker container selection
  - [ ] Evaluate `rich` library capabilities: Tables, Panels, Prompts, Color coding, Keyboard input
  - [ ] Evaluate alternative libraries: `questionary`, `inquirer`, `prompt_toolkit`
  - [ ] Document pros/cons of each library for validation workflow
  - [ ] Make library selection recommendation: Primary choice + fallback

- [ ] **Task 2: Define User Action Taxonomy** (AC: 3)
  - [ ] Define 5 core user actions: Confirm, Reject, Modify, Add, Change Pseudonym
  - [ ] Specify keyboard shortcuts for each action: Space, R, E, A, C
  - [ ] Define batch operations: Accept All, Reject All, Skip to Next Type
  - [ ] Define navigation: Next, Previous, Jump to Entity #N, Quit
  - [ ] Document action descriptions and when to use each

- [ ] **Task 3: Design Entity Presentation Format** (AC: 2)
  - [ ] Design entity grouping: Group by type (PERSON, LOCATION, ORG)
  - [ ] Design entity display: Entity text, Suggested pseudonym, Confidence score, Context snippet
  - [ ] Design context snippet: 10 words before/after entity, highlighted entity
  - [ ] Design ambiguity indicators: Warning icon, color coding, explanatory text
  - [ ] Design confidence score display: Percentage, color-coded (green >80%, yellow 60-80%, red <60%)

- [ ] **Task 4: Design Validation Workflow Steps** (AC: 4)
  - [ ] Step 1 - Summary Screen: Total entities, breakdown by type, estimated validation time
  - [ ] Step 2 - Entity Type Review: Iterate through PERSON ‚Üí ORG ‚Üí LOCATION
  - [ ] Step 3 - Ambiguous Entity Review: Flag standalone components (FR4 logic)
  - [ ] Step 4 - Final Confirmation: Summary of changes, confirm before processing
  - [ ] Design screen transitions: Smooth flow between steps, clear progress indicators

- [ ] **Task 5: Create ASCII Wireframe Mockups** (AC: 7)
  - [ ] Mockup 1: Summary screen with entity breakdown
  - [ ] Mockup 2: Entity review screen with single entity display
  - [ ] Mockup 3: Batch operations menu
  - [ ] Mockup 4: Ambiguous entity warning screen
  - [ ] Mockup 5: Final confirmation screen
  - [ ] Mockup 6: Edge cases (0 entities, 100+ entities, long entity names)

- [ ] **Task 6: Design Performance Optimization Strategies** (AC: 5)
  - [ ] Lazy loading: Load entities page-by-page (10-20 entities at a time)
  - [ ] Context precomputation: Precompute context snippets before user interaction
  - [ ] Keyboard-only navigation: No mouse required, fast keyboard shortcuts
  - [ ] Smart defaults: Pre-accept high-confidence entities (>90% confidence) with "Review Accepted" option
  - [ ] Progress indicators: Show "Entity 5/23" to set expectations

- [ ] **Task 7: Document Psychological Framing Strategy** (AC: 9)
  - [ ] Positive framing: "Quality Control Review" not "Fix AI Mistakes"
  - [ ] Default to AI suggestions: User confirms/overrides (not selects from scratch)
  - [ ] Progress feedback: "23 entities found! Quick review before processing..."
  - [ ] Time estimates: "~2 minutes estimated" to set expectations
  - [ ] Success messaging: "Review complete! Processing with 100% accuracy..."

- [ ] **Task 8: Create Validation UI Specification Document** (AC: 1-9)
  - [ ] Section 1: Overview (Mandatory validation, user experience goals)
  - [ ] Section 2: Library Selection (rich library + rationale)
  - [ ] Section 3: User Action Taxonomy (5 core actions + keyboard shortcuts)
  - [ ] Section 4: Entity Presentation Format (display, grouping, context)
  - [ ] Section 5: Validation Workflow Steps (4 steps with wireframes)
  - [ ] Section 6: Performance Optimization (lazy loading, precomputation, keyboard-only)
  - [ ] Section 7: Psychological Framing (positive messaging, time estimates)
  - [ ] Section 8: Edge Cases (0 entities, 100+ entities, errors)
  - [ ] Section 9: Example Validation Session (walkthrough with sample document)
  - [ ] Save to: `docs/validation-ui-spec.md`

- [ ] **Task 9: Create User Feedback Session Protocol** (AC: 8)
  - [ ] Prepare 5-minute feedback session script
  - [ ] Show wireframe mockups to 1-2 target users
  - [ ] Ask key questions: "Does this look fast or slow?", "Is the workflow clear?", "Any confusing parts?"
  - [ ] Measure reaction: Rate 1-5 scale for "speed perception", "clarity", "ease of use"
  - [ ] Document feedback and iterate on wireframes if needed

- [ ] **Task 10: Conduct PM and Dev Review** (AC: 8)
  - [ ] PM review: User experience perspective, psychological framing, time estimates
  - [ ] Dev review: Implementation feasibility, rich library capabilities, performance concerns
  - [ ] Collect feedback and incorporate into specification
  - [ ] Get sign-off from PM and Dev before finalizing

- [ ] **Task 11: Define Validation Time Benchmarking Protocol** (AC: 5)
  - [ ] Select 5 sample documents from test corpus (varying entity counts: 5, 15, 30, 50, 100 entities)
  - [ ] Create manual timing protocol: Stopwatch, record time per entity, total time
  - [ ] Define target: <2 minutes for 2-5K word document (avg 20-30 entities)
  - [ ] Calculate acceptable time per entity: ~3-5 seconds per entity review
  - [ ] Document as success criteria: If validation takes >3 minutes for 30 entities, iterate on UX

---

## Dev Notes

### Context from Story 1.2 Benchmark Results

**CRITICAL FINDING: Validation Mode is MANDATORY for MVP**

Story 1.2 NLP benchmark revealed severe accuracy limitations:
- spaCy: 29.5% F1 score (55% below 85% target)
- Stanza: 11.9% F1 score (73% below 85% target)

**Contingency Plan Selected: Option 1+3**
- **Option 1:** Lower threshold + **make validation mode MANDATORY**
- **Option 3:** Hybrid approach (NLP + regex patterns) to improve to 40-50% F1

**User Interaction Implications:**
- Users will spend **80% of their time** in validation workflow (not just 20%)
- Validation UI is now **CORE MVP FEATURE**, not optional enhancement
- Target: Enable users to verify 50-70% of entities efficiently
- User perception: "AI-assisted workflow" not "fully automatic tool"

[Source: docs/prd/epic-0-pre-sprint-preparation-v2-rescoped.md]

---

### Project Structure Context

**Documentation Location:** `docs/` [Source: architecture/12-unified-project-structure.md]
- `docs/validation-ui-spec.md` - **NEW in Story 0.4** - Validation UI specification document
- Existing docs: `docs/prd.md`, `docs/architecture.md`, `docs/nlp-benchmark-report.md`

**CLI Module Location:** `gdpr_pseudonymizer/cli/` [Source: architecture/12-unified-project-structure.md]
- `gdpr_pseudonymizer/cli/commands/` - Command implementations (future stories)
- `gdpr_pseudonymizer/cli/validators.py` - Input validation (future stories)
- `gdpr_pseudonymizer/cli/formatters.py` - Output formatting (future stories)

**Core Module Location:** `gdpr_pseudonymizer/core/` [Source: architecture/12-unified-project-structure.md]
- `gdpr_pseudonymizer/core/validation_handler.py` - **NEW in Epic 1** - Validation logic implementation
- `gdpr_pseudonymizer/core/orchestrator.py` - Core workflow orchestration (future stories)

**Note:** Story 0.4 is **DESIGN ONLY** - No code implementation. Implementation happens in Epic 1 Story 1.7 (moved from Epic 3).

---

### Tech Stack Requirements

**CLI UI Library:** rich 13.7+ [Source: architecture/3-tech-stack.md#progress-bars]
- Purpose: CLI UX enhancements (progress bars, formatted tables, colored error messages)
- Features needed for validation UI:
  - `rich.table.Table` - Entity display in tabular format
  - `rich.panel.Panel` - Grouped sections (PERSON, LOCATION, ORG)
  - `rich.prompt.Confirm` - Yes/no confirmation prompts
  - `rich.prompt.Prompt` - Text input for manual entity additions
  - `rich.console.Console` - Color-coded output, syntax highlighting
  - `rich.progress.Progress` - Progress bars for batch validation

**Alternative Libraries (Evaluation Needed):**
- `questionary` - Interactive CLI prompts with better keyboard navigation
- `inquirer` - Terminal UI toolkit with list selection, checkbox prompts
- `prompt_toolkit` - Low-level terminal UI library (more complex, more control)

**Selection Criteria:**
- Already in tech stack? (rich is, others are not)
- Keyboard-only navigation support
- Color-blind safe color palettes
- Performance with 100+ entities
- Accessibility (screen reader compatible)

---

### Validation Handler Component Specifications

**Component:** Validation Mode Handler [Source: architecture/6-components.md#validation-mode-handler]

**Responsibility:** Interactive entity review when validation mode enabled (FR7, FR18), present detected entities to user, allow corrections/additions/removals, apply user modifications before final pseudonymization.

**Key Interfaces:**
- `ValidationHandler.present_entities(entities) -> List[Entity]` (user interaction)
- `ValidationHandler.allow_corrections(entity) -> Entity`

**Dependencies:**
- Rich library (formatted tables, interactive prompts)
- Core Orchestrator (receives modified entity list)

**Key Design Decisions:** [Source: architecture/6-components.md#validation-mode-handler]
- **UPDATED: Default ON (not OFF):** Validation mode now MANDATORY by default for MVP (FR18 updated)
- **Batch vs Single:** In batch mode with validation, review all entities from all documents before processing begins (one review session, not per-document)
- **Ambiguity Highlighting:** Entities with `is_ambiguous=True` shown in different color, user prompted to confirm or correct
- **Modification Logging:** All user changes logged in `Operation.user_modifications` field for audit trail (FR12)

---

### Updated Functional Requirements (Post-Benchmark)

**FR7 - Validation Mode:** [Source: docs/prd/PRD-UPDATES-v2-assisted-mode.md#fr7]

**BEFORE (Original):** Optional interactive validation mode (activated via `--validate` flag). Validation mode is recommended but not required.

**AFTER (Updated):** **MANDATORY interactive validation mode** that presents detected entities and classification results for user review before pseudonymization is applied. Users may confirm, correct, add, or remove entities to ensure 100% accuracy despite AI detection limitations (40-50% automatic coverage). Validation mode includes:
- Confidence score display (if available from NER)
- Context snippets (surrounding text)
- Batch operations (accept all PERSON, reject all false positives)
- Entity addition (manual capture of missed entities)
- Pseudonym override (change suggested pseudonym)

**FR18 - Default Validation Behavior:** [Source: docs/prd/PRD-UPDATES-v2-assisted-mode.md#fr18]

**BEFORE (Original):** Disable validation mode by default (fast processing). Require explicit `--validate` flag to enable.

**AFTER (Updated):** **Enable validation mode by default** (mandatory review) to ensure accuracy given AI detection limitations. Users MUST review and confirm all detected entities before pseudonymization is applied. The `--validate` flag is not required (validation is always active in MVP). In batch mode, validation occurs before batch processing begins: users review entities from all documents, then batch proceeds with validated entity list.

---

### Core Workflow Context

**Single Document Pseudonymization with Validation:** [Source: architecture/8-core-workflows.md#single-document-pseudonymization]

Updated workflow with mandatory validation:
1. User runs `gdpr-pseudo process input.txt output.txt`
2. CLI reads input file
3. Core Orchestrator detects entities via NLP Engine
4. **VALIDATION STEP (NEW - MANDATORY):**
   - ValidationHandler presents entities to user
   - User reviews, confirms, corrects, adds, or removes entities
   - ValidationHandler returns validated entity list
5. Core Orchestrator processes validated entities (mapping lookup, pseudonym assignment)
6. File Handler applies replacements and writes output
7. Audit Repository logs operation with user modifications

**Batch Processing with Validation:** [Source: architecture/8-core-workflows.md#batch-processing]

Updated workflow with mandatory validation:
1. User runs `gdpr-pseudo batch documents/ output/ --workers 4`
2. Batch Processor spawns 4 worker processes
3. Workers detect entities from all 50 documents in parallel
4. Main process aggregates all detected entities (750 entities across 50 docs)
5. **VALIDATION STEP (BEFORE BATCH PROCESSING):**
   - ValidationHandler presents ALL 750 entities to user in one session
   - User reviews entities grouped by type and document
   - User makes corrections, additions, removals
   - ValidationHandler returns validated entity list (e.g., 720 entities after corrections)
6. Batch Processor proceeds with validated entity list
7. Workers apply replacements and write output files

**Key Architectural Decision:** Validate BEFORE batch processing (not during or after) to avoid interrupting parallel workflow.

---

### Validation UI Design Principles

**1. Speed and Efficiency (AC1, AC5):**
- Keyboard-driven: Space (confirm), R (reject), E (edit), A (add), N (next)
- Batch operations: "Accept all PERSON", "Reject all ORG" for bulk actions
- Smart defaults: Pre-accept high-confidence entities (>90% confidence)
- Target: <2 minutes for 20-30 entities (3-5 seconds per entity review)

**2. Psychological Framing (AC9):**
- Positive framing: "Quality Control Review" not "Fix AI Mistakes"
- Default to AI suggestions: User confirms/overrides (not selects from scratch)
- Progress feedback: "23 entities found! Quick review before processing..."
- Time estimates: "~2 minutes estimated" to set clear expectations
- Success messaging: "Review complete! Processing with 100% accuracy..."

**3. Entity Presentation (AC2):**
- Grouped by type: PERSON (most critical) ‚Üí ORG ‚Üí LOCATION
- Show context: 10 words before/after entity, highlighted entity
- Display confidence: Percentage + color-coded (green >80%, yellow 60-80%, red <60%)
- Ambiguity indicators: Warning icon for standalone components (e.g., "Marie" without "Dubois")

**4. User Actions (AC3):**
- ‚úÖ Confirm: Accept entity and suggested pseudonym (Space key)
- ‚ùå Reject: Remove false positive (R key)
- ‚úèÔ∏è Modify: Edit entity text (E key, opens text input)
- ‚ûï Add: Manually add missed entity (A key, opens form)
- üîÑ Change Pseudonym: Override suggested pseudonym (C key, opens pseudonym picker)

**5. Workflow Steps (AC4):**
- Step 1 - Summary: "23 entities detected: 15 PERSON, 5 LOCATION, 3 ORG. Estimated review: ~2 minutes."
- Step 2 - Entity Review: Iterate through entities by type, show one at a time with context
- Step 3 - Ambiguous Review: Flag entities like "Marie" (standalone component) for confirmation
- Step 4 - Final Confirmation: "Review complete. 20 entities confirmed, 3 rejected. Proceed with processing? [Y/n]"

---

### Performance Optimization Strategies

**Lazy Loading (AC5):** [Source: Epic 0 Story 0.4, architecture/6-components.md]
- Load entities page-by-page (10-20 entities at a time)
- Don't render 100+ entities at once (terminal performance issues)
- Pagination: "Showing 1-10 of 23 entities. [N]ext, [P]revious"

**Context Precomputation (AC5):**
- Precompute context snippets (10 words before/after entity) before user interaction
- Cache document text for fast context lookups
- Avoid re-reading file for each entity

**Keyboard-Only Navigation (AC1, AC5):**
- No mouse required (accessibility + speed)
- Single-key shortcuts: Space (confirm), R (reject), E (edit), A (add), N (next)
- Batch operations: Shift+A (accept all PERSON), Shift+R (reject all false positives)

**Smart Defaults (AC1):**
- Pre-accept high-confidence entities (>90% confidence) with "Review Accepted" option
- Show accepted entities in green, pending entities in yellow
- Allow user to review accepted entities if desired

---

### Edge Cases to Handle

**Edge Case 1: 0 Entities Detected**
- Display: "No entities detected. Document may not contain sensitive data, or NLP failed."
- Actions: [A]dd entity manually, [Q]uit without processing, [P]roceed anyway
- Note: With 29.5% F1, this scenario is likely (false negatives)

**Edge Case 2: 100+ Entities Detected**
- Display: "100 entities detected. This will take ~10 minutes to review."
- Strategy: Pagination (10-20 entities per page), batch operations ("Accept all PERSON")
- Warning: Consider splitting document if >200 entities

**Edge Case 3: Long Entity Names**
- Example: "Dr. Jean-Pierre Marie-Christine Dubois-Leclerc" (50+ characters)
- Display: Truncate entity name with ellipsis if >40 characters
- Show full name in context snippet

**Edge Case 4: Ambiguous Standalone Components**
- Example: "Marie" appears 5 times, but only 2 are part of "Marie Dubois"
- Display: Warning icon, "Ambiguous: Standalone component. Related to 'Marie Dubois'?"
- Actions: [C]onfirm as separate entity, [M]erge with "Marie Dubois", [R]eject

**Edge Case 5: Confidence Score Unavailable**
- If NER doesn't provide confidence scores (Stanza doesn't always)
- Display: "Confidence: N/A" in gray text
- Skip smart defaults (can't pre-accept without confidence)

---

### Example Validation Session Walkthrough

**Scenario:** User processes `interview_transcript_01.txt` (2,340 words) with 23 detected entities.

```
$ gdpr-pseudo process interview_transcript_01.txt output.txt

‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë GDPR Pseudonymizer - Entity Validation                                      ‚ïë
‚ïë File: interview_transcript_01.txt (2,340 words)                             ‚ïë
‚ï†‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï£
‚ïë                                                                              ‚ïë
‚ïë Detected: 23 entities (15 PERSON, 5 LOCATION, 3 ORG)                        ‚ïë
‚ïë Review: 2-3 minutes estimated                                                ‚ïë
‚ïë                                                                              ‚ïë
‚ïë ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚ïë
‚ïë ‚îÇ PERSON Entities (15 found)                                  [1/3]        ‚îÇ ‚ïë
‚ïë ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§ ‚ïë
‚ïë ‚îÇ 1. Marie Dubois              ‚Üí Leia Organa     [‚úì Confirm] [‚úó Reject]  ‚îÇ ‚ïë
‚ïë ‚îÇ    Context: "...interview with Marie Dubois about..."                   ‚îÇ ‚ïë
‚ïë ‚îÇ    Confidence: 95%                                                       ‚îÇ ‚ïë
‚ïë ‚îÇ                                                                          ‚îÇ ‚ïë
‚ïë ‚îÇ 2. Dr. Jean-Pierre Martin    ‚Üí Luke Skywalker  [‚úì Confirm] [‚úó Reject]  ‚îÇ ‚ïë
‚ïë ‚îÇ    Context: "...Dr. Jean-Pierre Martin explained..."                    ‚îÇ ‚ïë
‚ïë ‚îÇ    Confidence: 87%                                                       ‚îÇ ‚ïë
‚ïë ‚îÇ                                                                          ‚îÇ ‚ïë
‚ïë ‚îÇ 3. Marie                     ‚Üí Leia ‚ö†Ô∏è          [‚úì Confirm] [‚úó Reject]  ‚îÇ ‚ïë
‚ïë ‚îÇ    Context: "...when Marie said this..."                                ‚îÇ ‚ïë
‚ïë ‚îÇ    ‚ö†Ô∏è  Ambiguous: Standalone component. Related to "Marie Dubois"?      ‚îÇ ‚ïë
‚ïë ‚îÇ                                                                          ‚îÇ ‚ïë
‚ïë ‚îÇ [Space] Confirm current | [R] Reject | [E] Edit | [A] Add | [N] Next   ‚îÇ ‚ïë
‚ïë ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚ïë
‚ïë                                                                              ‚ïë
‚ïë Actions: [Shift+A] Accept all PERSON | [S] Skip to LOCATION | [H] Help     ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù

> User presses Space (confirm) for entity 1
> User presses Space (confirm) for entity 2
> User presses R (reject) for entity 3 (standalone "Marie" likely refers to "Marie Dubois")
> User reviews remaining 12 PERSON entities...
> User skips to LOCATION (5 entities), confirms all
> User skips to ORG (3 entities), rejects 1 false positive

‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë Review Complete                                                              ‚ïë
‚ï†‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï£
‚ïë                                                                              ‚ïë
‚ïë Summary:                                                                     ‚ïë
‚ïë   ‚Ä¢ 20 entities confirmed (13 PERSON, 5 LOCATION, 2 ORG)                    ‚ïë
‚ïë   ‚Ä¢ 3 entities rejected (2 PERSON false positives, 1 ORG false positive)    ‚ïë
‚ïë   ‚Ä¢ 0 entities added                                                         ‚ïë
‚ïë                                                                              ‚ïë
‚ïë Proceed with pseudonymization? [Y/n]                                        ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù

> User presses Y (confirm)

Processing interview_transcript_01.txt...
‚úì 20 entities pseudonymized
‚úì Output written to output.txt
‚úì Processing complete (14.2s)
```

**Total validation time:** ~2.5 minutes (within target <3 minutes for 23 entities)

---

### Architecture References

All technical details extracted from source documents:

- **Tech Stack (rich library):** [Source: architecture/3-tech-stack.md#progress-bars]
- **Project Structure (docs, CLI module):** [Source: architecture/12-unified-project-structure.md]
- **Validation Handler Component:** [Source: architecture/6-components.md#validation-mode-handler]
- **Core Workflows (with validation):** [Source: architecture/8-core-workflows.md]
- **Epic 0 Story 0.4 Requirements:** [Source: docs/prd/epic-0-pre-sprint-preparation-v2-rescoped.md#story-04]
- **Updated FR7 & FR18 (Mandatory Validation):** [Source: docs/prd/PRD-UPDATES-v2-assisted-mode.md#fr7-fr18]
- **Story 1.2 Benchmark Results:** [Source: docs/stories/1.2.comprehensive-nlp-library-benchmark.story.md#dev-agent-record]
- **Positioning Document (AI-Assisted):** [Source: docs/prd/PRD-UPDATES-v2-assisted-mode.md]

---

## Testing

### Test File Locations
- No unit tests for Story 0.4 (design-only story, no code implementation)
- Validation UI implementation tests in Epic 1 Story 1.7: `tests/unit/test_validation_handler.py`

### Testing Standards
- Story 0.4 is **DESIGN ONLY** - No code implementation or automated tests
- Testing is user feedback sessions with 1-2 target users (AC8)
- Success criteria: User feedback rates workflow ‚â•3/5 for speed, clarity, ease of use

### Test Requirements

1. **User Feedback Session (AC8):**
   - Show wireframe mockups to 1-2 target users
   - Ask key questions: "Does this look fast or slow?", "Is the workflow clear?", "Any confusing parts?"
   - Measure reaction: Rate 1-5 scale for "speed perception", "clarity", "ease of use"
   - Success criteria: ‚â•3/5 rating on all dimensions
   - If <3/5 on any dimension, iterate on wireframes and re-test

2. **PM Review (AC8):**
   - Review user experience perspective
   - Validate psychological framing strategy
   - Confirm time estimates are realistic
   - Sign off on specification before Epic 1 begins

3. **Dev Review (AC8):**
   - Review implementation feasibility with rich library
   - Confirm keyboard-only navigation is achievable
   - Validate performance optimization strategies
   - Sign off on specification before Epic 1 begins

4. **Validation Time Benchmarking (AC5):**
   - Manual timing with 5 sample documents (5, 15, 30, 50, 100 entities)
   - Stopwatch timing: Simulate user reviewing entities at 3-5 seconds per entity
   - Calculate: 30 entities √ó 4 seconds/entity = 120 seconds (~2 minutes) - PASS
   - Success criteria: <2 minutes for 20-30 entities (typical document)

---

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2026-01-16 | 1.0 | Initial story draft created | Scrum Master (Bob) |

---

## Dev Agent Record

### Agent Model Used

**Primary Model:** [To be recorded by Dev Agent - N/A for design-only story]

### Debug Log References

[N/A - Design-only story, no code implementation]

### Completion Notes List

[To be recorded by PM/Scrum Master during design phase]

**Expected Deliverables:**
1. `docs/validation-ui-spec.md` - Comprehensive validation UI specification document
2. Wireframe mockups (ASCII format) embedded in specification
3. User feedback session results (1-2 users)
4. PM and Dev sign-off on specification
5. Library selection recommendation (rich vs alternatives)

### File List

**Files to be Created:**
- `docs/validation-ui-spec.md` - Validation UI specification document (comprehensive)
- `docs/validation-ui-wireframes.txt` - ASCII wireframe mockups (if separate from spec)
- `docs/validation-ui-feedback.md` - User feedback session results (optional, can be in spec)

**Files to be Modified:**
- None (design-only story, no code changes)

---

## QA Results

[To be completed by QA Agent after design phase - Design review, not code review]

**Expected QA Activities:**
- Review specification completeness (all 9 ACs addressed)
- Validate wireframes are clear and actionable for developers
- Confirm user feedback session was conducted with ‚â•3/5 ratings
- Verify PM and Dev sign-off documented
- Check that specification enables Epic 1 Story 1.7 implementation without blockers
